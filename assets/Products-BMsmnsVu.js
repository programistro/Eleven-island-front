import{r as l,j as e,h as H,i as V,k as Z,c as O}from"./index-B6U29ZPA.js";import{B as R,S as Q}from"./SendEmail-NBJy7Jqa.js";import{u as U}from"./store-u8fOXZZW.js";import{C as D}from"./CloasModal-DFrSFvne.js";const Y="data:image/svg+xml,%3csvg%20width='9'%20height='5'%20viewBox='0%200%209%205'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8%201L4.5%204L1%201'%20stroke='%23262626'%20stroke-linecap='square'%20stroke-linejoin='round'/%3e%3c/svg%3e",P="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='20'%20height='20'%20fill='%23262626'/%3e%3cpath%20d='M15%207L8.75%2013L5%2010.2727'%20stroke='white'%20stroke-width='2'%20stroke-linecap='square'%20stroke-linejoin='round'/%3e%3c/svg%3e";function j({resetValue:i=!1,title:n="",value:s=[],colors:c=!1,phone:m=!1,open:y,toggle:v,onClick:S=()=>{},id:k}){var f,C,p,g;const[d,w]=l.useState(n==="Размер"?{label:"Размер",value:"*"}:{value:((C=(f=s==null?void 0:s.vlaueSelect)==null?void 0:f.filter(t=>(t==null?void 0:t.value)===k))==null?void 0:C.value)||"",label:((g=(p=s==null?void 0:s.vlaueSelect)==null?void 0:p.filter(t=>(t==null?void 0:t.value)===k))==null?void 0:g.label)||""});if(l.useEffect(()=>{var t,h;i&&w({value:((t=s==null?void 0:s[0])==null?void 0:t.value)||"",label:((h=s==null?void 0:s[0])==null?void 0:h.label)||""})},[i]),l.useEffect(()=>{d&&(d.value==="*"?S(null):S(d.value))},[d]),console.log("vlaueSelect",d),!m)return e.jsxs("div",{className:"custom-select",children:[e.jsxs("button",{onClick:v,className:"flex items-center gap-[7px]",children:[d.value?d.label:n," ",e.jsx("img",{src:Y,alt:"StrelkaBottom"})]}),y&&e.jsx("ul",{className:`${n=="Сортировать по"&&"right-0"} customUl p-[20px] bg-white text-black w-[250px] flex flex-col gap-[15px]`,children:s&&(s==null?void 0:s.map(t=>e.jsxs("li",{onClick:()=>{w(t),v()},className:"cursor-pointer flex gap-[10px] items-center",children:[e.jsx("div",{className:"check-box-custom",children:d.value==t.value?e.jsx("img",{src:P,alt:"CheckTrue"}):""}),t.label]},t.value)))})]});if(m)return e.jsxs("div",{className:"phone-select-filter",children:[e.jsx("h2",{children:n}),e.jsx("ul",{className:`${n=="Размер"?"phone-size-filter-ul":"flex-col"}  pt-[15px] bg-white text-black w-[250px] flex  gap-[15px]`,children:s&&(s==null?void 0:s.map(t=>e.jsxs("li",{onClick:()=>{w(t)},className:"cursor-pointer flex gap-[10px] items-center",children:[e.jsx("div",{className:"check-box-custom",children:d.value==t.value?e.jsx("img",{src:P,alt:"CheckTrue"}):""}),c?c.map(h=>e.jsx("div",{style:{width:"15px",borderRadius:"50%",background:h}},h)):t.label]},t.value)))})]})}const q="data:image/svg+xml,%3csvg%20width='14'%20height='11'%20viewBox='0%200%2014%2011'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.97569%208.35714H1M13%208.35714H12.9933M12.9933%202.64286H8.99556M1.00666%202.64286H1M8.95133%206.21429C10.0492%206.21429%2010.9392%207.17368%2010.9392%208.35714C10.9392%209.54061%2010.0492%2010.5%208.95133%2010.5C7.85347%2010.5%206.96348%209.54061%206.96348%208.35714C6.96348%207.17368%207.85347%206.21429%208.95133%206.21429ZM4.97567%200.5C6.07353%200.5%206.96352%201.45939%206.96352%202.64286C6.96352%203.82632%206.07353%204.78571%204.97567%204.78571C3.87782%204.78571%202.98783%203.82632%202.98783%202.64286C2.98783%201.45939%203.87782%200.5%204.97567%200.5Z'%20stroke='%23262626'%20stroke-linecap='round'/%3e%3c/svg%3e";function J({modalStateFilter:i,setModalStateFilter:n,componentDiv:s}){const[c,m]=l.useState(!1);return l.useEffect(()=>{c&&m(!1)},[c]),e.jsx("div",{className:"boxModalBasket",style:{zIndex:i?1e6:-999,opacity:i?1:0},children:e.jsxs("div",{className:"componentModalFilter",children:[e.jsxs("div",{className:"componentModalHeaderFilter",children:[e.jsx("button",{onClick:()=>n(!1),children:e.jsx("img",{src:D,alt:"CloasModal"})}),e.jsx("h2",{children:"Фильтр"}),e.jsx("button",{onClick:()=>m(!0),children:"Сбросить"})]}),e.jsx("div",{className:"FilterBox",children:s(c)})]})})}function K({modalStateReset:i,element:n}){const{setModalStateReset:s}=H();return e.jsx("div",{className:"boxModalBasket",style:{zIndex:i?"1":-99999,opacity:i?1:0,position:"absolute",background:"transparent",justifyContent:"end",paddingTop:"125px",paddingRight:"19px"},children:e.jsxs("div",{className:"componentModalReset",children:[e.jsxs("div",{className:"componentModalHeaderReset",children:[e.jsx("div",{}),e.jsx("button",{onClick:()=>s(!1),children:e.jsx("img",{src:D,alt:"CloasModal"})})]}),e.jsx("div",{className:"ResetBox",children:n})]})})}const W=i=>{const[n,s]=l.useState(window.matchMedia(i).matches);return l.useEffect(()=>{const c=window.matchMedia(i),m=()=>s(c.matches);return c.addEventListener("change",m),()=>c.removeEventListener("change",m)},[i]),n};function ae(){const{id:i}=V(),{photos:n,fetchPhotos:s}=U(),[c,m]=l.useState(""),{modalStateFilter:y,setModalStateFilter:v}=Z(),{setModalStateReset:S,modalStateReset:k}=H(),[d,w]=l.useState(null),[f,C]=l.useState([]),[p,g]=l.useState(1),[t,h]=l.useState([]),[r,b]=l.useState({reset:!0}),[L,I]=l.useState(),B=[{label:"Все размеры",value:"*"},{label:"XXS",value:"XXS"},{label:"XS",value:"XS"},{label:"S",value:"S"},{label:"M",value:"M"},{label:"L",value:"L"},{label:"XL",value:"XL"},{label:"XXL",value:"XXL"}],[M,F]=l.useState(!1),T=async()=>{await s({page:p||1,limit:50,categoryId:r==null?void 0:r.categoryId,size:c})},z=[{label:"По убыванию цены",value:"1"},{label:"По возрастанию цены",value:"2"}],_=async()=>{const o=localStorage.getItem("token");try{const u=(await O.get("/Category/get-all-categories",{headers:{Authorization:`Bearer ${o}`}})).data;console.log("newPhotos",u),C([{label:"Все типы",value:""},...u.map(x=>({label:x==null?void 0:x.name,value:x==null?void 0:x.categoryId}))])}catch(a){console.error("Error fetching photos:",a)}};l.useEffect(()=>{_()},[]);const X=W("(min-width: 1020px)"),E=o=>{w(d===o?null:o)};return l.useEffect(()=>{T()},[p,c,r,L]),l.useEffect(()=>{n.length>0&&h(o=>[...o,...n.filter(a=>!o.some(u=>u.id===a.id)).map(a=>{var u,x;return{...a,jobpositions:(x=(u=a.jobpositions)==null?void 0:u.filter(N=>N.end_date))==null?void 0:x.sort((N,$)=>{const A=parseInt(N.end_date.replace(/-/g,""),10);return parseInt($.end_date.replace(/-/g,""),10)-A})}})])},[n]),l.useEffect(()=>{const o=()=>{const a=window.innerHeight+window.scrollY,u=document.documentElement.offsetHeight-100;a>=u&&!M&&(F(!0),g(x=>x+1))};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[M]),l.useEffect(()=>{M&&(async()=>{await s({categoryId:r==null?void 0:r.categoryId,limit:50,page:p}),F(!1)})()},[p,M]),l.useEffect(()=>{g(0),h([]),b({...r,categoryId:i})},[]),l.useEffect(()=>{h(c==="*"||!c?n:o=>o.filter(a=>{var u;return(u=a==null?void 0:a.sizes)==null?void 0:u.some(x=>!0)}))},[c,n]),l.useEffect(()=>{if(t&&t.length>0){const o=[...t];h(o)}},[L]),console.log("===================================="),console.log("selectedSizes",c),console.log("dateSearch",r),console.log("typeSelect",f),console.log("id",i),console.log("===================================="),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"filterBar",children:[e.jsx("h2",{children:"Каталог"}),e.jsxs("div",{children:[" ",X?(f==null?void 0:f.length)>0&&e.jsxs("div",{className:"filterProbucts",children:[e.jsx(j,{onClick:o=>{g(0),h([]),b({...r,categoryId:o})},title:"Тип продукции",open:d==="type",toggle:()=>E("type"),value:f}),e.jsx(j,{onClick:o=>{m(o),g(0),b({...r,reset:!r.reset})},title:"Размер",value:B,open:d==="size",toggle:()=>E("size")})]}):e.jsxs("button",{onClick:()=>v(!0),className:"btn-filter-phone",children:[e.jsx("img",{src:q,alt:"iconFilter"}),"Фильтр"]}),X?e.jsx("div",{className:"max-w-auto",children:e.jsx(j,{onClick:o=>{g(0),I(o)},title:"Сортировать по",value:z,open:d==="sort",toggle:()=>E("sort")})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>S(!0),className:"btn-filter-phone",children:"Сортировать по"}),e.jsx(K,{element:e.jsx(j,{onClick:o=>{g(0),I(o)},title:"Сортировать по",value:z,phone:!0}),modalStateReset:k})]})]})]}),e.jsxs("div",{className:"contentProducts",children:[e.jsx(R,{arrDataImg:t==null?void 0:t.filter((o,a)=>a<8)}),e.jsx(Q,{}),e.jsx(R,{arrDataImg:t==null?void 0:t.filter((o,a)=>a>8)})]}),e.jsx(J,{modalStateFilter:y,setModalStateFilter:v,componentDiv:o=>e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:a=>{g(0),h([]),b({...r,categoryId:a})},resetValue:o,title:"Тип продукции",phone:!0,value:f,id:i}),e.jsx(j,{onClick:a=>{m(a),g(0),b({...r,reset:!r.reset})},resetValue:o,title:"Размер",value:B,phone:!0})]})})]})}export{ae as default};
