import{i as E,r as a,j as e,L as p,g as f,c as w}from"./index-B6U29ZPA.js";function S({onHash:m=!1}){const{hash:h}=E(),[u,n]=a.useState(!1),[o,x]=a.useState({email:"",password:""}),[t,c]=a.useState({emailError:"",passwordError:""}),g=async r=>{r.preventDefault();let s={};const i=localStorage.getItem("token");if(o.email?!/^\S+@\S+\.\S+$/.test(o.email)&&!/^\d{9,15}$/.test(o.email)?s.emailError="Введите корректный email или телефон!":s.emailError="":s.emailError="Поле не должно быть пустым!",o.password?o.password.length<4?s.passwordError="Пароль должен содержать не менее 4 символов!":s.passwordError="":s.passwordError="Поле не должно быть пустым!",c(s),!s.emailError&&!s.passwordError)try{const l=await f.post("https://elevenislands.ru/token",{guest:!1,username:o.email,password:o.password,remember_me:!0},{headers:{Authorization:`Bearer ${i}`}});localStorage.setItem("token",l.data.access_token)}catch(l){console.error(l),c({emailError:"Неправильный логин или пароль."})}},d=(r,s)=>{x(i=>({...i,[r]:s}))},j=async r=>{n(!1);try{const s=w.post(`${r}`);console.log("res",s.data)}catch(s){console.error(s)}finally{n(!0)}};return a.useEffect(()=>{m&&j(h)},[]),e.jsx("div",{className:"login-box",children:u?e.jsx("div",{className:"loading-login",children:e.jsx("h1",{children:"Идет подтверждение E-mail, пожалуйста, подождите!"})}):e.jsxs("div",{className:"box-login",children:[e.jsx("h2",{children:"Вход"}),e.jsxs("form",{onSubmit:g,className:"input-login",children:[e.jsxs("div",{className:"login-inputs",children:[e.jsx("label",{htmlFor:"input-email-and-tell",children:"Email или телефон"}),e.jsx("input",{onChange:r=>d("email",r.target.value),type:"text",id:"input-email-and-tell"}),t.emailError&&e.jsx("p",{style:{bottom:"-17px",position:"absolute",color:"red"},children:t.emailError})]}),e.jsxs("div",{className:"login-inputs",children:[e.jsx("label",{htmlFor:"input-password",children:"Пароль"}),e.jsx("input",{onChange:r=>d("password",r.target.value),type:"password",id:"input-password"}),t.passwordError&&e.jsx("p",{style:{bottom:"-17px",position:"absolute",color:"red"},children:t.passwordError})]}),e.jsxs("div",{className:"dop-options-login",children:[e.jsx("p",{children:e.jsx(p,{to:"/create-password",children:"Забыли пароль?"})}),e.jsx("p",{children:e.jsx(p,{to:"/registration",children:"Регистрация"})})]}),e.jsx("button",{type:"submit",className:"button-login",children:"Войти"})]})]})})}export{S as default};
